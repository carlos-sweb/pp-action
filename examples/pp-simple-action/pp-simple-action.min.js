"use strict";function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable});keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}(function(factory){var root=(typeof self==="undefined"?"undefined":_typeof(self))=="object"&&self.self===self&&self||(typeof global==="undefined"?"undefined":_typeof(global))=="object"&&global.global===global&&global;if(typeof define==="function"&&define.amd){define(["exports"],function(exports){root.ppView=factory(root,exports);module.exports=root.ppView})}else if(typeof exports!=="undefined"){factory(root,exports)}else{root.ppView=factory(root,{})}})(function(root,ppView){var isBooleanAttr=function isBooleanAttr(attrName){var booleanAttributes=["disabled","checked","required","readonly","hidden","open","selected","autofocus","itemscope","multiple","novalidate","allowfullscreen","allowpaymentrequest","formnovalidate","autoplay","controls","loop","muted","playsinline","default","ismap","reversed","async","defer","nomodule"];return booleanAttributes.includes(attrName)},lisenEvent={window:["afterprint","beforeprint","beforeunload","error","hashchange","load","message","offline","online","pagehide","pageshow","popstate","resize","storage","unload"],mouse:["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","wheel"],keyboard:["keydown","keypress","keyup"],drag:["drag","dragend","dragenter","dragleave","dragover","dragstart","drop","scroll"],clipboard:["copy","cut","paste"],media:[],form:["blur","change","contextmenu","focus","input","invalid","reset","search","select","submit"]},rAttr=function rAttr(el,attr){el.removeAttribute(attr)},setAttr=function setAttr(el,attr,vl){el.setAttribute(attr,vl)},hasAttr=function hasAttr(el,attr){return el.hasAttribute(attr)},getAttr=function getAttr(el,attr){return hasAttr(el,attr)?el.getAttribute(attr):""},qAll=function qAll(el,selector){return el.querySelectorAll(selector)},debounce=function debounce(func,wait){var timeoutId;return function(){if(timeoutId){clearTimeout(timeoutId)}var context=this;var args=arguments;timeoutId=setTimeout(function(){func.apply(context,args)},wait)}},pick=function pick(){var args=[].slice.call(arguments);var result={};if(args.length>1){var theObject=args[0];args.shift();if(_typeof(theObject)=="object"){args.forEach(function(arg){if(typeof arg=="string"){if(theObject.hasOwnProperty(arg)){result[arg]=theObject[arg]}}})}return Object.assign(_objectSpread({},result),{})}else{return result}},omit=function omit(){var args=[].slice.call(arguments);var result={};if(args.length>1){var theObject=args[0];args.shift();if(_typeof(theObject)=="object"){result=_objectSpread({},theObject);args.forEach(function(arg){if(typeof arg=="string"){if(theObject.hasOwnProperty(arg)){delete result[arg]}}})}return Object.assign(_objectSpread({},result),{})}else{return result}},getLisenEvent=function getLisenEvent(){var result=[];for(var i in lisenEvent){result=result.concat(lisenEvent[i])}return result};return function(options){var _this3=this;this.saferEval=function(expression,dataContext){var additionalHelperVariables=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};return new Function(["$data"].concat(_toConsumableArray(Object.keys(additionalHelperVariables))),"var result; with($data) { result = ".concat(expression," };return result")).bind(this).apply(void 0,[dataContext].concat(_toConsumableArray(Object.values(additionalHelperVariables))))};this.events={};this.on=function(eventName,callbacks){if(isString(eventName)){if(isFunction(callbacks)){if(!this.events.hasOwnProperty(eventName)){this.events[eventName]=[]}this.events[eventName].push(callbacks)}}};this.removeListener=function(eventName,callbacks){var idx;if(_typeof(this.events[eventName])==="object"){}};this.emit=function(eventName){var i,listeners,length,args=[].slice.call(arguments,1);if(_typeof(this.events[eventName])==="object"){listeners=this.events[eventName].slice();length=listeners.length;for(i=0;i<length;i++){listeners[i].apply(this,args)}}};this.el=document.querySelector(options.el||null);this.watch=options.watch||{};this.form=options.form||{};this.$form={};this.data=options.data||{};this.methods=options.methods||{};this.filters=options.filters||{};this.template=options.template||null;this.el.innerHTML=this.template;this.detectingChangeData=function(data,NativeEvent){var keys=Object.keys(data);for(var i=0;i<keys.length;i++){var key=keys[i];if(data.hasOwnProperty(key)){if(data[key]!=this.data[key]){if(this.watch.hasOwnProperty(key)){if(typeof this.watch[key]=="function"){this.watch[key](data[key],this.data[key],NativeEvent)}}this.emit("dataChange");break}}else{if(this.watch.hasOwnProperty(key)){if(typeof this.watch[key]=="function"){this.watch[key](data[key],this.data[key],NativeEvent)}}this.emit("dataChange");break}}};this.handleTextDirective=function(el,output){var old_value=el.innerText;if((typeof output=="function"?output():output)!=old_value){el.innerText=typeof output==="function"?output():output}};this.handleHtmlDirective=function(el,output){var old_value=el.innerHTML;el.innerHTML=typeof output==="function"?output():output;this.initialize(el)};this.handleShowDirective=function(el,output){el.style.display=output?"":"none"};this.initializeDirectivesComplex=function(el){};this.initializeDirectives=function(el){var _this=this;var el=el||this.el;["maxlength","minlength","max","min","text","html","show","disabled","readonly","required"].forEach(function(attrCatch){qAll(el,"[pp-"+attrCatch+"]").forEach(function(attrEl){var expression=getAttr(attrEl,"pp-"+attrCatch);if(expression!=""&&expression!=null){var expressionArray=expression.split("|").map(function(value){return value.trim()});var output="";var form=attrEl.getAttribute("pp-data-form");var $form=void 0;if(form!=null){if(_this.$form.hasOwnProperty(form)){$form=_this.$form[form]}}try{output=_this.saferEval(expressionArray[0],_objectSpread(_objectSpread({},_this.data),{$form:$form}),_this.methods);if(expressionArray.length>1){for(var iterator=1;iterator<expressionArray.length;iterator++){var Filtro=expressionArray[iterator];if(_this.filters.hasOwnProperty(Filtro)){if(isString(output)){output=_this.filters[Filtro](output)}}}}}catch(messageError){console.warn(messageError)}if(attrCatch=="text"){_this.handleTextDirective(attrEl,output)}if(attrCatch=="show"){_this.handleShowDirective(attrEl,output)}if(attrCatch=="disabled"){_this.handleDisabledDirective(attrEl,output)}if(attrCatch=="readonly"){_this.handleReadonlyDirective(attrEl,output)}if(attrCatch=="required"){_this.handleRequiredDirective(attrEl,output)}if(attrCatch=="html"){_this.handleHtmlDirective(attrEl,output)}if(attrCatch=="maxlength"){_this.handleMaxLengthDirective(attrEl,output)}if(attrCatch=="minlength"){_this.handleMinLengthDirective(attrEl,output)}if(attrCatch=="max"){_this.handleMaxDirective(attrEl,output)}if(attrCatch=="min"){_this.handleMinDirective(attrEl,output)}}})})};this.HelperFunctionInitialize=function(NativeEvent,stringAttribute){var target=NativeEvent.target;var expression=getAttr(target,stringAttribute);var $data=_objectSpread({},this.data);var form=getAttr(target,"pp-data-form");var $form=null;if(this.$form.hasOwnProperty(form)){$form=this.$form[form]}var $dataTemporal=Object.assign(_objectSpread({},this.data),{$el:target,$event:NativeEvent,$form:$form});try{var safer=this.saferEval(expression,$dataTemporal,this.methods)}catch(messageError){console.log(messageError)}this.data=_objectSpread({},omit($dataTemporal,"$el","$event"));this.detectingChangeData($data,NativeEvent)};var h=function h(root,attr,remove){return function hf(NativeEvent){root.HelperFunctionInitialize(NativeEvent,attr);if(remove){NativeEvent.target.removeEventListener(NativeEvent.type,hf)}}};this.initialize=function(el){var _this2=this;var iTime=Date.now();var el=el||this.el;getLisenEvent().forEach(function(lEvent){qAll(el,"[pp-"+lEvent+"]").forEach(function(ElEvent){var attrNameEvent="pp-"+lEvent,expresion=getAttr(ElEvent,attrNameEvent);ElEvent.addEventListener(lEvent,h(_this2,attrNameEvent,false))});qAll(el,"[pp-"+lEvent+"-once]").forEach(function(ElEventOnce){var attrNameEventOnce="pp-"+lEvent+"-once";var expresionOnce=getAttr(ElEventOnce,attrNameEventOnce);ElEventOnce.addEventListener(lEvent,h(_this2,attrNameEventOnce,true))})});this.initializeModel(el);this.initializeDirectivesAll(el);console.log(Date.now()-iTime)};this.initializeDirectivesAll=function(el){this.initializeDirectivesComplex(el);this.initializeDirectives(el)};this.on("dataChange",function(){_this3.initializeDirectivesAll(_this3.el)});this.initialize(this.el);this.emit("finished")}});